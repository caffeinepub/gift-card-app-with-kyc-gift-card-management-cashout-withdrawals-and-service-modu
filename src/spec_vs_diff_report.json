{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-07T20:09:08.578Z",
  "summary": "Core send-to-bank flow is partially implemented across backend and frontend (payout methods, withdrawals UI/hooks, crypto wallet quick action + sheet, and a migration module). However, the backend withdrawal API does not match the requested spec (missing currency and createdAt naming), and the diff includes many unrelated frontend features/changes (gift cards, betting page, global CSS/theme updates).",
  "missing_requirements": [
    {
      "id": "REQ-1",
      "requirement": "Creating a payout method validates required fields (bank name, account name, account number).",
      "reason": "Backend method createPayoutMethod traps only on authorization; no evidence of non-empty/required-field validation in the shown implementation.",
      "evidence": [
        "backend/main.mo"
      ]
    },
    {
      "id": "REQ-2",
      "requirement": "Backend exposes a method to create a withdrawal request with (amount, currency, payoutMethodId).",
      "reason": "createWithdrawalRequest in the diff only accepts (payoutMethodId, amount) and there is no currency field on WithdrawalRequest in backend/main.mo.",
      "evidence": [
        "backend/main.mo"
      ]
    },
    {
      "id": "REQ-2",
      "requirement": "Withdrawal requests include createdAt timestamps (and status defaults to pending).",
      "reason": "The backend type uses field name `created` rather than `createdAt`. While status defaults to #pending, the required createdAt field name is not present in the shown type.",
      "evidence": [
        "backend/main.mo",
        "backend/migration.mo"
      ]
    },
    {
      "id": "REQ-3",
      "requirement": "Backend admin methods to list all pending withdrawals and update a withdrawal status to paid/rejected (setting processedAt and processedBy) with non-admin access denied.",
      "reason": "The diff snippet for backend/main.mo is truncated before any admin-specific methods appear; no concrete evidence in the provided diff summary that these admin Candid methods and authorization checks exist.",
      "evidence": [
        "backend/main.mo (truncated)"
      ]
    }
  ],
  "hallucinated_features": [
    {
      "description": "Large set of gift-card related UI/components/pages and catalog updates unrelated to send-to-bank/payout methods/withdrawals.",
      "reason": "Not requested by any REQ-1..REQ-6; diff summary shows multiple gift card components/pages and brand catalog changes.",
      "evidence": [
        "frontend/src/config/giftCardBrandCatalog.ts",
        "frontend/src/components/giftcards/GiftCardBrandRow.tsx",
        "frontend/src/components/giftcards/SelectGiftCardCategoryPicker.tsx",
        "frontend/src/pages/giftcards/AddGiftCardPage.tsx",
        "frontend/src/pages/giftcards/GiftCardDetailPage.tsx (truncated)",
        "frontend-file-summaries.txt"
      ]
    },
    {
      "description": "New/changed betting page placeholder feature.",
      "reason": "Not requested by any requirement in the BuildRequest.",
      "evidence": [
        "frontend/src/pages/services/BettingPage.ts",
        "frontend-file-summaries.txt"
      ]
    },
    {
      "description": "Global CSS/theme token updates (purple/blue scheme, safe-area utility) not specifically required for the send-to-bank flow.",
      "reason": "Not mentioned in REQ-1..REQ-6 and not necessary to meet the stated acceptance criteria based on the diff summary.",
      "evidence": [
        "frontend/src/index.css",
        "frontend-file-summaries.txt"
      ]
    },
    {
      "description": "Profile setup modal behavior changes unrelated to the requested send-to-bank flow.",
      "reason": "Not requested by any REQ-1..REQ-6.",
      "evidence": [
        "frontend/src/components/profile/ProfileSetupModal.tsx",
        "frontend-file-summaries.txt"
      ]
    }
  ],
  "confidence": 0.66,
  "changed_files": [
    "backend/main.mo",
    "backend/migration.mo",
    "frontend-file-summaries.txt",
    "frontend/src/components/crypto/CryptoQuickActions.tsx",
    "frontend/src/components/crypto/sheets/SendToBankSheet.tsx",
    "frontend/src/hooks/useQueries.ts",
    "frontend/src/lib/utils.ts",
    "frontend/src/pages/admin/AdminWithdrawalsPage.tsx",
    "frontend/src/pages/services/CryptoWalletPage.tsx",
    "frontend/src/pages/withdrawals/WithdrawalsPage.tsx",
    "project_state.json"
  ]
}